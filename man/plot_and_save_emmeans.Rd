% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/plot_and_save_emmeans.R
\name{plot_and_save_emmeans}
\alias{plot_and_save_emmeans}
\title{Plot and Save Estimated Marginal Means (EMMs)}
\usage{
plot_and_save_emmeans(
  model_object,
  specs,
  variable_of_interest,
  color_by,
  output_dir = NULL
)
}
\arguments{
\item{model_object}{A fitted model object from which EMMs are to be computed. This can be a generalized linear model (GLM), linear model, or other suitable models.}

\item{specs}{A character string specifying the predictor variable(s) for which EMMs are to be computed. For example, this could be the treatment groups, scenarios, or demographic variables.}

\item{variable_of_interest}{A character string specifying the variable to be plotted on the x-axis. Typically, this would be the same as the \code{specs}.}

\item{color_by}{A character string specifying the variable used to color the points and error bars. This could be a categorical variable like gender, insurance type, or academic affiliation.}

\item{output_dir}{A character string specifying the directory where the plot will
be saved. Defaults to a session-specific folder inside \code{\link[=tempdir]{tempdir()}}.}
}
\value{
Invisibly returns a list containing the estimated marginal means data (\code{data}) and the ggplot object (\code{plot}).
}
\description{
This function computes the estimated marginal means (EMMs) from a model object, creates a plot of the EMMs with confidence intervals, and saves the plot to a specified directory. This is particularly useful in studies like mystery caller studies where you need to analyze differences in outcomes such as appointment wait times across different groups or treatments.
}
\details{
The function computes EMMs using the \code{emmeans} package, which provides adjusted means (or other summary statistics) for the levels of factors, corrected for the influence of other predictors in the model. This is particularly useful in the context of mystery caller studies, where you might want to compare outcomes such as appointment wait times between different insurance types, scenarios, or demographic groups, while controlling for potential confounders.

The plot generated by this function displays the EMMs along with their 95\% confidence intervals, making it easy to visualize the differences between groups. The plot is saved to a specified directory with a unique filename that includes a timestamp.
}
\examples{
\dontrun{
# Example 1: Comparing Appointment Wait Times Between Scenarios
# Assume 'model' is a fitted GLM object with appointment wait time as the outcome
result <- plot_and_save_emmeans(
  model_object = model,
  specs = "scenario",
  variable_of_interest = "scenario",
  color_by = "insurance",
  output_dir = "Figures/ScenarioComparison"
)

# Example 2: Comparing EMMs Across Different Insurance Types
# Assume 'model' is a fitted GLM object
result <- plot_and_save_emmeans(
  model_object = model,
  specs = "insurance",
  variable_of_interest = "insurance",
  color_by = "academic",
  output_dir = "Figures/InsuranceComparison"
)

# Example 3: Visualizing EMMs for Different Age Groups in a Mystery Caller Study
# Assume 'model' is a fitted GLM object with age groups as a factor
result <- plot_and_save_emmeans(
  model_object = model,
  specs = "age_group",
  variable_of_interest = "age_group",
  color_by = "gender",
  output_dir = "Figures/AgeGroupComparison"
)

# Example 4: Interaction Effects Between Gender and Insurance Type
# Assume 'model' is a fitted GLM object
result <- plot_and_save_emmeans(
  model_object = model,
  specs = c("gender", "insurance"),
  variable_of_interest = "gender",
  color_by = "insurance",
  output_dir = "Figures/InteractionEffects"
)
}

}
