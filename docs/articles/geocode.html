<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Geocoding • tyler</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Geocoding">
<meta name="description" content="A function to geocode addresses.
">
<meta property="og:description" content="A function to geocode addresses.
">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">tyler</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.2.1</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>TRUE</h6></li>
    <li><a class="dropdown-item" href="../articles/create_isochrones.html">Gathering Drive Time Isochrones</a></li>
    <li><a class="dropdown-item" href="../articles/geocode.html">Geocoding</a></li>
    <li><a class="dropdown-item" href="../articles/get_census_data.html">Getting Data from the US Census Bureau for Isochrones</a></li>
    <li><a class="dropdown-item" href="../articles/imotive-news.html">Imotive News &amp; Changelog</a></li>
    <li><a class="dropdown-item" href="../articles/my-vignette.html">Searching the NPI Database Starting with Taxonomy Codes</a></li>
    <li><a class="dropdown-item" href="../articles/search_and_process_npi.html">Search and Process NPI Numbers</a></li>
    <li><a class="dropdown-item" href="../articles/aggregating_provider_data.html">Aggregating Provider Data for Analysis</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../reference/index.html#datasets">Datasets</a></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/mufflyt/tyler/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Geocoding</h1>
                        <h4 data-toc-skip class="author">Tyler Muffly,
MD</h4>
            
      
      <small class="dont-index">Source: <a href="https://github.com/mufflyt/tyler/blob/HEAD/vignettes/geocode.Rmd" class="external-link"><code>vignettes/geocode.Rmd</code></a></small>
      <div class="d-none name"><code>geocode.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="overview">Overview<a class="anchor" aria-label="anchor" href="#overview"></a>
</h2>
<p>The <code>geocode</code> function is designed to help you geocode
datasets containing addresses and change them to lattitude and
longitude.</p>
<div class="section level3">
<h3 id="step-1">Step 1<a class="anchor" aria-label="anchor" href="#step-1"></a>
</h3>
<div class="section level4">
<h4 id="installation">Installation<a class="anchor" aria-label="anchor" href="#installation"></a>
</h4>
<p>Before you can harness the power of the
<code>search_by_taxonomy</code> function, it is essential to ensure that
you have the <code>tyler</code> package installed. You can effortlessly
install it using the following command:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://mufflyt.github.io/mystery/" class="external-link">tyler</a></span><span class="op">)</span></span></code></pre></div>
</div>
</div>
</div>
<div class="section level2">
<h2 id="example-usage">Example Usage<a class="anchor" aria-label="anchor" href="#example-usage"></a>
</h2>
<div class="section level3">
<h3 id="understanding-geocoding">Understanding Geocoding<a class="anchor" aria-label="anchor" href="#understanding-geocoding"></a>
</h3>
<p>Certainly! Geocoding, the process of converting addresses or place
names into geographic coordinates (latitude and longitude), has its
advantages and disadvantages. Here’s an overview of the pluses and
minuses of geocoding:</p>
<p><strong>Pluses of Geocoding:</strong></p>
<ul>
<li><ol style="list-style-type: decimal">
<li>
<strong>Location Accuracy:</strong> Geocoding provides precise
location information, allowing you to pinpoint addresses or places on a
map with high accuracy. This is crucial for various applications such as
mapping, navigation, and location-based services.</li>
</ol></li>
<li><ol start="2" style="list-style-type: decimal">
<li>
<strong>Spatial Analysis:</strong> Geocoded data enables spatial
analysis, allowing you to perform tasks like proximity analysis, spatial
clustering, and spatial interpolation. It’s invaluable for geographic
information systems (GIS) and geographic research.</li>
</ol></li>
<li><ol start="3" style="list-style-type: decimal">
<li>
<strong>Geographic Visualization:</strong> Geocoded data can be
visualized on maps, making it easier to understand and communicate
spatial patterns and trends. This is particularly useful for data
presentation and decision-making.</li>
</ol></li>
<li><ol start="4" style="list-style-type: decimal">
<li>
<strong>Routing and Navigation:</strong> Geocoding is essential for
navigation systems, delivery route optimization, and location-based apps
that provide directions and estimated travel times.</li>
</ol></li>
</ul>
<p><strong>Minuses of Geocoding:</strong></p>
<ul>
<li><ol style="list-style-type: decimal">
<li>
<strong>Data Quality Issues:</strong> Geocoding accuracy heavily
relies on the quality of the underlying address data. Inaccurate or
outdated address information can lead to geocoding errors.</li>
</ol></li>
<li><ol start="2" style="list-style-type: decimal">
<li>
<strong>Costs:</strong> Geocoding services or software often come
with associated costs, particularly for large-scale geocoding
operations. These costs can include data licensing fees and usage
charges.</li>
</ol></li>
<li><ol start="3" style="list-style-type: decimal">
<li>
<strong>Complexity:</strong> Advanced geocoding tasks, such as
reverse geocoding (converting coordinates to addresses) and batch
geocoding, can be technically complex and may require expertise or
specialized tools.</li>
</ol></li>
</ul>
<p>In summary, geocoding offers numerous benefits in terms of location
accuracy, spatial analysis, visualization, and navigation. However, it
also comes with challenges related to data quality, costs, and
complexity. Careful consideration of these factors is essential when
using geocoding in various applications.</p>
<p><strong>Do not geocode from Zip codes</strong> There are several
issues and limitations associated with geocoding solely based on zip
codes:</p>
<ul>
<li><p>Lack of Precision: Zip codes are designed to cover a group of
addresses or an area, not specific points. Therefore, geocoding based
solely on a zip code provides only an approximation of the location,
often at the center or centroid of the zip code area. This lack of
precision can be problematic for applications that require accurate
coordinates.</p></li>
<li><p>Zip Code Boundaries: Zip code boundaries can be irregular and may
not align with natural or administrative boundaries. This means that
geocoding based on zip codes can result in coordinates that do not
reflect the actual geography of the area, leading to
inaccuracies.</p></li>
<li><p>Zip Code Changes: Zip code boundaries and assignments can change
over time due to population growth, urban development, or administrative
reasons. Geocoding based on outdated zip code data can lead to incorrect
locations.</p></li>
<li><p>Large Zip Codes: Some zip codes cover vast geographic areas,
especially in rural regions. Geocoding to the center of such large zip
code areas can be highly inaccurate for specific locations within that
area.</p></li>
<li><p>Overlapping Zip Codes: In some cases, zip codes may overlap with
one another. Geocoding based solely on a zip code may not distinguish
between the overlapping areas, leading to ambiguity.</p></li>
<li><p>Urban Density: In densely populated urban areas, zip codes can be
small and densely packed with addresses. Geocoding solely by zip code
may still result in a lack of precision when trying to identify a
particular location within a zip code.</p></li>
</ul>
</div>
<div class="section level3">
<h3 id="step-2-prepare-your-data">Step 2: Prepare Your Data<a class="anchor" aria-label="anchor" href="#step-2-prepare-your-data"></a>
</h3>
<p>You can provide your data as either a dataframe or a CSV file in the
argument <code>input_data</code>. Under the hood
<code><a href="https://rdrr.io/pkg/ggmap/man/geocode.html" class="external-link">ggmap::geocode</a></code> is accessing a Google API.
<code><a href="https://rdrr.io/pkg/ggmap/man/geocode.html" class="external-link">ggmap::geocode</a></code> is the program AHRQ uses.</p>
<ul>
<li>If your data is in a CSV file, pass the file path as the input_data
parameter.</li>
</ul>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">output_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/geocode_unique_addresses.html">geocode_unique_addresses</a></span><span class="op">(</span></span>
<span>    file_path <span class="op">=</span><span class="st">"address_for_geocoding.csv"</span>,</span>
<span>    google_maps_api_key <span class="op">=</span> <span class="st">"123"</span>,</span>
<span>    output_file_path <span class="op">=</span> <span class="st">"data/geocoded_unique_addresses.csv"</span><span class="op">)</span></span></code></pre></div>
<ul>
<li>Sometimes the data needs to have separate <code>lat</code> and
<code>long</code> columns. This code can do that:</li>
</ul>
<pre><code><span><span class="va">geocoded_data1</span> <span class="op">&lt;-</span> <span class="va">geocoded_data</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>        <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html" class="external-link">mutate</a></span><span class="op">(</span>lat <span class="op">=</span> <span class="fu">sf</span><span class="fu">::</span><span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_coordinates.html" class="external-link">st_coordinates</a></span><span class="op">(</span><span class="va">.</span><span class="op">)</span><span class="op">[</span>, <span class="st">"Y"</span><span class="op">]</span>,</span>
<span>               long <span class="op">=</span> <span class="fu">sf</span><span class="fu">::</span><span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_coordinates.html" class="external-link">st_coordinates</a></span><span class="op">(</span><span class="va">.</span><span class="op">)</span><span class="op">[</span>, <span class="st">"X"</span><span class="op">]</span><span class="op">)</span></span></code></pre>
<ul>
<li><p>How do you match the <code>geocoded_data</code> with the orginal
dataframe? You can use the <code>postmastr</code> package that allows
the addresses in both dataframes to be parsed into house number, street,
state, etc. Once in their individual parts you can do a join together.
This seems janky af.</p></li>
<li><p>postmast’s functionality rests on an order of operations that
must be followed to ensure correct parsing:</p></li>
<li><p>prep</p></li>
<li><p>postal code</p></li>
<li><p>state</p></li>
<li><p>city</p></li>
<li><p>unit</p></li>
<li><p>house number</p></li>
<li><p>ranged house number</p></li>
<li><p>fractional house number</p></li>
<li><p>house suffix</p></li>
<li><p>street directionals</p></li>
<li><p>street suffix</p></li>
<li><p>street name</p></li>
<li><p>reconstruct</p></li>
</ul>
<pre><code><span><span class="co"># install.packages("remotes")</span></span>
<span>      <span class="co"># remotes::install_github("slu-openGIS/postmastr")</span></span>
<span>      <span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/slu-openGIS/postmastr" class="external-link">postmastr</a></span><span class="op">)</span></span>
<span>      <span class="va">abc</span> <span class="op">&lt;-</span> <span class="fu">read_csv</span><span class="op">(</span><span class="va">csv_file</span><span class="op">)</span></span>
<span>      <span class="va">abc</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://rdrr.io/pkg/postmastr/man/pm_identify.html" class="external-link">pm_identify</a></span><span class="op">(</span>var <span class="op">=</span> <span class="st">"address"</span><span class="op">)</span> <span class="op">-&gt;</span> <span class="va">sushi2</span></span>
<span>      <span class="va">sushi2_min</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/postmastr/man/pm_prep.html" class="external-link">pm_prep</a></span><span class="op">(</span><span class="va">sushi2</span>, var <span class="op">=</span> <span class="st">"address"</span>, type <span class="op">=</span> <span class="st">"street"</span><span class="op">)</span></span>
<span>      <span class="fu"><a href="https://rdrr.io/pkg/postmastr/man/pm_postal_all.html" class="external-link">pm_postal_all</a></span><span class="op">(</span><span class="va">sushi2_min</span><span class="op">)</span></span>
<span>      <span class="va">sushi2_min</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/postmastr/man/pm_postal_parse.html" class="external-link">pm_postal_parse</a></span><span class="op">(</span><span class="va">sushi2_min</span><span class="op">)</span></span>
<span>      <span class="va">moDict</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/postmastr/man/pm_dictionary.html" class="external-link">pm_dictionary</a></span><span class="op">(</span>locale <span class="op">=</span> <span class="st">"us"</span>, type <span class="op">=</span> <span class="st">"state"</span>, case <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"title"</span>, <span class="st">"upper"</span><span class="op">)</span><span class="op">)</span></span>
<span>      <span class="va">moDict</span></span>
<span>      <span class="fu"><a href="https://rdrr.io/pkg/postmastr/man/pm_state_all.html" class="external-link">pm_state_all</a></span><span class="op">(</span><span class="va">sushi2_min</span>, dictionary <span class="op">=</span> <span class="va">moDict</span><span class="op">)</span> <span class="co">#Checks to make sure that all states have matches</span></span>
<span>      <span class="va">sushi2_min</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/postmastr/man/pm_state_parse.html" class="external-link">pm_state_parse</a></span><span class="op">(</span><span class="va">sushi2_min</span>, dictionary <span class="op">=</span> <span class="va">moDict</span><span class="op">)</span></span>
<span>      <span class="fu"><a href="https://rdrr.io/pkg/postmastr/man/pm_house_all.html" class="external-link">pm_house_all</a></span><span class="op">(</span><span class="va">sushi2_min</span><span class="op">)</span></span>
<span>      <span class="va">sushi2_min</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/postmastr/man/pm_house_parse.html" class="external-link">pm_house_parse</a></span><span class="op">(</span><span class="va">sushi2_min</span><span class="op">)</span></span>
<span>      <span class="va">sushi2_min</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/postmastr/man/pm_streetDir_parse.html" class="external-link">pm_streetDir_parse</a></span><span class="op">(</span><span class="va">sushi2_min</span><span class="op">)</span></span>
<span>      <span class="va">sushi2_min</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/postmastr/man/pm_streetSuf_parse.html" class="external-link">pm_streetSuf_parse</a></span><span class="op">(</span><span class="va">sushi2_min</span><span class="op">)</span></span>
<span>      <span class="va">sushi2_min</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/postmastr/man/pm_street_parse.html" class="external-link">pm_street_parse</a></span><span class="op">(</span><span class="va">sushi2_min</span>, ordinal <span class="op">=</span> <span class="cn">TRUE</span>, drop <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span>      <span class="va">sushi2_parsed</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/postmastr/man/pm_replace.html" class="external-link">pm_replace</a></span><span class="op">(</span><span class="va">sushi2_min</span>, source <span class="op">=</span> <span class="va">sushi2</span><span class="op">)</span></span>
<span>      <span class="fu">readr</span><span class="fu">::</span><span class="fu"><a href="https://readr.tidyverse.org/reference/write_delim.html" class="external-link">write_csv</a></span><span class="op">(</span><span class="va">sushi2_parsed</span>, <span class="st">"~/Dropbox (Personal)/workforce/Master_References/NPPES/NPPES_November_filtered_data_address_parsed.csv"</span><span class="op">)</span></span></code></pre>
</div>
</div>
<div class="section level2">
<h2 id="conclusion">Conclusion<a class="anchor" aria-label="anchor" href="#conclusion"></a>
</h2>
<p>The validate_and_remove_invalid_npi function is a handy tool for
cleaning and validating datasets with NPI numbers. By following the
steps outlined in this vignette, you can ensure that your data contains
only valid NPIs for further analysis and processing.</p>
</div>
<div class="section level2">
<h2 id="features-and-bugs">Features and bugs<a class="anchor" aria-label="anchor" href="#features-and-bugs"></a>
</h2>
<p>If you have ideas for other features that would make name handling
easier, or find a bug, the best approach is to either report it or add
it!</p>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Tyler Muffly.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer>
</div>





  </body>
</html>
